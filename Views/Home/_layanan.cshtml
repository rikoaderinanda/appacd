<div class="col-12">
  <div class="home-categories mt-30">
    <div class="main-title d-flex align-items-center mb-3">
      <strong class="mb-0">Layanan paling populer</strong>
      <a href="@Url.Action("Index", "Layanan")" class="ms-auto text-decoration-none text-secondary small">Lihat
        Semua</a>
    </div>
    <div class="category-group">
      <div class="owl-carousel category-slider" id="layananCarousel">
        <!-- Loading skeletons -->
        <div class="item">
          <div class="cate-item text-center loading-skeleton">
            <div class="cate-img mb-2 skeleton-circle"></div>
            <p class="mb-0 small fw-semibold text-dark text-truncate skeleton-text"></p>
          </div>
        </div>
        <div class="item">
          <div class="cate-item text-center loading-skeleton">
            <div class="cate-img mb-2 skeleton-circle"></div>
            <p class="mb-0 small fw-semibold text-dark text-truncate skeleton-text"></p>
          </div>
        </div>
        <div class="item">
          <div class="cate-item text-center loading-skeleton">
            <div class="cate-img mb-2 skeleton-circle"></div>
            <p class="mb-0 small fw-semibold text-dark text-truncate skeleton-text"></p>
          </div>
        </div>
        <div class="item">
          <div class="cate-item text-center loading-skeleton">
            <div class="cate-img mb-2 skeleton-circle"></div>
            <p class="mb-0 small fw-semibold text-dark text-truncate skeleton-text"></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (typeof window.jQuery === 'undefined') {
      console.error('jQuery is not loaded.');
      return;
    }
    var $ = window.jQuery;
    $.getJSON('/api/Layanan/GetLayanan', function (data) {
      var html = $.map(data, function (item) {
        var scr = "";
        scr = `
          <div class="item fade-in">
            <a href="/layanan/${encodeURIComponent(item.id)}" class="cate-item text-center">
              <div class="cate-img mb-2">
                <img src="${item.img_layanan}" class="img-fluid" loading="lazy" />
              </div>
              <p class="mb-0 small text-dark text-truncate">${item.nama_layanan}</p>
            </a>
          </div>
        `;
        return scr;
      }).join('');
      $('#layananCarousel').html(html);
      initCarousel("layananCarousel",4);
      lazyAnimateItems("layananCarousel");
    });

    Storage.clear('keranjang'); // Clear keranjang on page load

  });
</script>
